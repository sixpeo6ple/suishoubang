# 登录接口

## 1.登录

> 请不要重复登录

接口地址：

```api
https://api.suishoubang.myrating.cn/login/doLogin
```

测试代码：

```js
wx.request({
    url: 'https://api.suishoubang.myrating.cn/login/doLogin',
    method: 'Get',
    data: {
        //通过wx.login得到的code
        code: wx.getStorageSync('code')
    },
    success(r) {
        console.log(r);
        // 在登录时，将得到的数据存储在本地
        wx.setStorageSync('tokenName', r.data.data.tokenName)
        wx.setStorageSync('tokenValue', r.data.data.tokenValue)
        wx.setStorageSync('session_key', r.data.data.session_key)
    }
})
```

## 2.判断是否登录

> 测试是否正确携带请求头

接口地址：

```api
https://api.suishoubang.myrating.cn/login/isLogin
```

测试代码：

```js
function getHeader() {
    let tokenName = wx.getStorageSync('tokenName');   
    let tokenValue = wx.getStorageSync('tokenValue');   
    let header = {
        "content-type": "application/x-www-form-urlencoded"
    };
    if (tokenName != undefined && tokenName != '') {
        header[tokenName] = tokenValue;
    }
    return header;
}

module.exports = {
    getHeader
}
```

```js
// 在发起请求时将 header 对象塞到请求头部
// 通过tokenValue鉴别身份
wx.request({
    url: 'https://api.suishoubang.myrating.cn/login/isLogin',
    header: util.getHeader(),
    method: 'Get',
    success(r) {
        //学生认证后会返回学生用户登录
        console.log(r);
    }
})
```

